<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IPTV Master: TV OS Edition</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/hls.js@1.4.0/dist/hls.min.js"></script>
    <style>
        :root {
            /* TV OS Palette */
            --bg-deep: #050505;
            --bg-glass: rgba(30, 30, 40, 0.7);
            --bg-card: rgba(255, 255, 255, 0.05);
            --bg-card-hover: rgba(255, 255, 255, 0.15);
            
            --accent-yellow: #ffd700;
            --accent-purple: #b983ff;
            --accent-red: #ff4757;
            --accent-cyan: #00e5ff;
            
            --text-main: #ffffff;
            --text-dim: #aaaaaa;
            
            --glow: 0 0 20px rgba(0, 229, 255, 0.3);
            --tv-bezel: #1a1a1a;
            
            --font-ui: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }

        body {
            margin: 0; padding: 0;
            font-family: var(--font-ui);
            background-color: var(--bg-deep);
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(100, 0, 200, 0.2) 0%, transparent 40%),
                radial-gradient(circle at 90% 80%, rgba(0, 200, 255, 0.15) 0%, transparent 40%);
            color: var(--text-main);
            height: 100vh;
            display: flex; flex-direction: column; overflow: hidden;
        }

        /* --- LOAD SCREEN (TV MENU STYLE) --- */
        #loadScreen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 100;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            backdrop-filter: blur(10px);
            padding: 20px;
        }

        .load-box {
            background: var(--bg-glass);
            padding: 40px; border-radius: 24px;
            width: 100%; max-width: 600px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.1);
            text-align: center;
            max-height: 90vh; overflow-y: auto;
        }

        h2 { font-weight: 300; letter-spacing: 2px; text-transform: uppercase; margin-bottom: 30px; }
        h2 span { font-weight: 800; color: var(--accent-yellow); }

        .input-row { display: flex; gap: 10px; margin-bottom: 15px; }
        
        .url-input {
            flex: 1; 
            background: rgba(0,0,0,0.5); 
            border: 2px solid transparent;
            color: #fff; padding: 15px; border-radius: 12px; 
            font-size: 1rem; transition: 0.3s;
        }
        .url-input:focus { border-color: var(--accent-cyan); box-shadow: var(--glow); }

        /* Buttons TV Style */
        .btn-action {
            width: 100%; padding: 16px; border-radius: 12px; border: none;
            font-weight: 700; font-size: 1rem; cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            display: flex; align-items: center; justify-content: center; gap: 10px;
            margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px;
        }
        .btn-action:hover { transform: scale(1.02); filter: brightness(1.2); }
        .btn-action:active { transform: scale(0.98); }

        .btn-yellow { background: var(--accent-yellow); color: #000; box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3); }
        .btn-purple { background: linear-gradient(135deg, #a55eea, #8854d0); color: #fff; box-shadow: 0 4px 15px rgba(165, 94, 234, 0.4); }
        .btn-red { background: linear-gradient(135deg, #ff4757, #ff6b81); color: #fff; box-shadow: 0 4px 15px rgba(255, 71, 87, 0.4); }
        .btn-dark { background: rgba(255,255,255,0.1); color: #fff; }
        
        .section-divider { 
            display: flex; align-items: center; margin: 30px 0; color: var(--text-dim); font-size: 0.8rem; letter-spacing: 2px;
        }
        .section-divider::before, .section-divider::after {
            content: ""; flex: 1; height: 1px; background: rgba(255,255,255,0.2); margin: 0 10px;
        }

        /* --- LIST VIEW (GRID LAYOUT) --- */
        #listView {
            padding: 30px; height: 100%; width: 100%; max-width: 1400px; margin: 0 auto;
            display: none; flex-direction: column;
        }

        .search-container { position: relative; margin-bottom: 25px; }
        .search-input {
            width: 100%; background: var(--bg-card); border: 1px solid rgba(255,255,255,0.1);
            padding: 18px 25px 18px 50px; border-radius: 50px; color: #fff; font-size: 1.1rem;
            backdrop-filter: blur(5px);
        }
        .search-icon { position: absolute; left: 20px; top: 50%; transform: translateY(-50%); color: var(--text-dim); }

        .list-content { 
            flex: 1; overflow-y: auto; 
            display: grid; 
            /* Landscape Grid: Auto-fill wide cards */
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); 
            gap: 15px; padding-bottom: 20px;
        }

        /* Custom Scrollbar */
        .list-content::-webkit-scrollbar { width: 8px; }
        .list-content::-webkit-scrollbar-track { background: transparent; }
        .list-content::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 4px; }

        /* Channel Card (Landscape) */
        .channel-card {
            background: var(--bg-card);
            border: 1px solid rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 15px;
            display: flex; align-items: center; gap: 15px;
            transition: 0.2s; cursor: pointer;
            position: relative; overflow: hidden;
        }
        .channel-card:hover {
            background: var(--bg-card-hover);
            border-color: rgba(255,255,255,0.3);
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }
        /* Active/Playing state effect could be added here */

        .card-logo {
            width: 50px; height: 50px; border-radius: 8px;
            background: #000; display: flex; align-items: center; justify-content: center;
            font-weight: bold; color: #555; overflow: hidden; flex-shrink: 0;
        }
        .card-logo img { width: 100%; height: 100%; object-fit: cover; }

        .card-info { flex: 1; min-width: 0; /* Text truncation fix */ }
        .card-title { 
            font-weight: 600; font-size: 1rem; margin-bottom: 4px; 
            white-space: nowrap; overflow: hidden; text-overflow: ellipsis; 
        }
        .card-meta { display: flex; gap: 6px; font-size: 0.75rem; }
        
        .badge { 
            padding: 3px 8px; border-radius: 4px; font-weight: 700; text-transform: uppercase; 
            font-size: 0.65rem; letter-spacing: 0.5px;
        }
        .bg-cyan { background: rgba(0, 229, 255, 0.15); color: var(--accent-cyan); }
        .bg-purple { background: rgba(185, 131, 255, 0.15); color: var(--accent-purple); }
        .bg-gray { background: rgba(255,255,255,0.1); color: #aaa; }

        .play-icon {
            color: var(--accent-yellow); opacity: 0; transition: 0.2s; transform: translateX(-10px);
        }
        .channel-card:hover .play-icon { opacity: 1; transform: translateX(0); }

        /* --- PLAYER VIEW --- */
        #playerView { display: none; height: 100vh; flex-direction: column; }
        
        .player-header {
            height: 70px; display: flex; align-items: center; justify-content: space-between; 
            padding: 0 30px; background: rgba(0,0,0,0.3); backdrop-filter: blur(10px);
        }
        .btn-back {
            background: rgba(255,255,255,0.1); border: none; color: #fff;
            padding: 10px 20px; border-radius: 30px; cursor: pointer;
            display: flex; align-items: center; gap: 8px; font-weight: 600;
            transition: 0.2s;
        }
        .btn-back:hover { background: rgba(255,255,255,0.2); }

        .player-body { flex: 1; display: flex; align-items: center; justify-content: center; position: relative; overflow: hidden; }

        /* Retro TV Container (Desktop) */
        .tv-frame {
            background: var(--tv-bezel);
            padding: 20px; border-radius: 20px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.8), inset 0 0 20px rgba(0,0,0,1);
            position: relative; transition: all 0.5s ease;
            max-width: 95%; width: fit-content;
        }
        
        .screen-glass {
            background: #000; border-radius: 10px; overflow: hidden;
            border: 2px solid #000; position: relative;
            width: 900px; max-width: 100%; aspect-ratio: 16/9;
            box-shadow: inset 0 0 40px rgba(0,0,0,0.5);
        }

        video, iframe { width: 100%; height: 100%; border: none; display: block; }
        #foxContainer, #daddyContainer { display: none; width: 100%; height: 100%; background: #000; }

        /* Overlays */
        .res-badge {
            position: absolute; top: 20px; left: 20px; z-index: 20;
            background: rgba(0,0,0,0.6); color: #00ff00; 
            padding: 5px 10px; border-radius: 6px; font-family: monospace; font-size: 0.8rem;
            pointer-events: none; border: 1px solid rgba(0,255,0,0.3);
        }
        .screen-controls {
            position: absolute; top: 20px; right: 20px; z-index: 20; display: flex; gap: 10px;
        }
        .ctl-btn {
            background: rgba(0,0,0,0.6); border: 1px solid rgba(255,255,255,0.2);
            color: #fff; width: 35px; height: 35px; border-radius: 50%;
            cursor: pointer; display: flex; align-items: center; justify-content: center;
            transition: 0.2s;
        }
        .ctl-btn:hover { background: #fff; color: #000; }
        
        .tv-lights {
            position: absolute; bottom: 10px; right: 30px; display: flex; gap: 10px;
        }
        .light { width: 8px; height: 8px; border-radius: 50%; background: #333; }
        .light.on { background: #00ff00; box-shadow: 0 0 5px #00ff00; }

        /* Fullscreen Mods */
        .player-body.is-fullscreen .tv-frame {
            padding: 0; border-radius: 0; background: none; box-shadow: none; width: 100%; height: 100%;
        }
        .player-body.is-fullscreen .screen-glass {
            border-radius: 0; border: none; width: 100%; height: 100%;
        }
        .player-body.is-fullscreen .tv-lights { display: none; }

        /* --- MOBILE MODE (Auto-Switch) --- */
        @media (max-width: 768px) {
            body { background: #000; } /* Simpler bg for mobile */
            
            /* Load Screen */
            .load-box { padding: 20px; border: none; background: transparent; box-shadow: none; }
            h2 { font-size: 1.5rem; }
            .url-input { padding: 12px; font-size: 0.9rem; }
            .btn-action { padding: 14px; font-size: 0.9rem; }

            /* List View */
            #listView { padding: 15px; }
            .search-input { padding: 12px 15px 12px 40px; font-size: 1rem; }
            .search-icon { left: 15px; font-size: 0.9rem; }
            
            /* Grid becomes List on Mobile */
            .list-content { 
                grid-template-columns: 1fr; /* 1 Column */
                gap: 10px;
            }
            .channel-card { padding: 10px; }
            .card-logo { width: 40px; height: 40px; }
            .card-title { font-size: 0.95rem; }

            /* Player View */
            .player-header { height: 50px; padding: 0 15px; }
            .btn-back { padding: 6px 15px; font-size: 0.85rem; }
            
            /* Remove TV Frame on Mobile */
            .tv-frame { padding: 0; background: none; box-shadow: none; width: 100%; }
            .screen-glass { border-radius: 0; border: none; aspect-ratio: 16/9; width: 100%; }
            .tv-lights { display: none; }
            
            /* Status Log */
            #statusLog { font-size: 0.75rem; }
        }
    </style>
</head>
<body>

    <div id="loadScreen">
        <div class="load-box">
            <h2>IPTV <span>MASTER</span></h2>
            
            <div id="inputContainer">
                <div class="input-row">
                    <input type="text" class="url-input" value="https://iptv-org.github.io/iptv/index.m3u" placeholder="Playlist URL...">
                    <button class="btn-action btn-red" onclick="removeRow(this)" style="width:50px; margin:0;"><i class="fa-solid fa-times"></i></button>
                </div>
            </div>
            
            <button class="btn-action btn-dark" onclick="addInputRow()">
                <i class="fa-solid fa-plus"></i> Add Another Source
            </button>

            <button class="btn-action btn-yellow" onclick="loadAllPlaylists()">
                LOAD CHANNELS
            </button>

            <div class="section-divider">SPECIAL LIBRARIES</div>

            <button class="btn-action btn-purple" onclick="loadDaddyLive()">
                <i class="fa-solid fa-satellite-dish"></i> DADDY LIVE (750+)
            </button>

            <button class="btn-action btn-red" onclick="loadFoxTV()">
                <i class="fa-solid fa-tv"></i> FOX TV LIVE
            </button>

            <div id="statusLog" style="margin-top:20px; text-align:left; max-height:100px; overflow-y:auto; color:var(--text-dim); font-size:0.8rem; font-family:monospace;"></div>
        </div>
    </div>

    <div id="listView">
        <div class="search-container">
            <i class="fa-solid fa-search search-icon"></i>
            <input type="text" id="channelSearch" class="search-input" placeholder="Find a channel..." oninput="handleSearch()">
        </div>
        <div id="listContent" class="list-content"></div>
    </div>

    <div id="playerView">
        <div class="player-header">
            <button class="btn-back" onclick="goBack()">
                <i class="fa-solid fa-arrow-left"></i> <span id="backText">Library</span>
            </button>
            <div style="font-weight:bold; letter-spacing:1px;">NOW PLAYING</div>
        </div>

        <div class="player-body" id="playerBody">
            <div class="tv-frame">
                <div class="screen-glass">
                    <div id="resBadge" class="res-badge">Ready</div>
                    <div class="screen-controls">
                        <button class="ctl-btn" onclick="toggleCustomFullscreen()"><i class="fa-solid fa-expand"></i></button>
                    </div>

                    <video id="videoPlayer" controls></video>
                    <div id="foxContainer"></div> <div id="daddyContainer"></div> </div>

                <div class="tv-lights">
                    <div class="light on"></div>
                    <div class="light"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- CORE VARIABLES ---
        let allChannels = [];
        const video = document.getElementById('videoPlayer');
        const foxContainer = document.getElementById('foxContainer');
        const daddyContainer = document.getElementById('daddyContainer');
        const playerBody = document.getElementById('playerBody');
        const resBadge = document.getElementById('resBadge');
        let hls;
        let searchTimer;
        const RENDER_LIMIT = 100;

        // --- DADDYLIVE DATA (Your Exact 750 list integrated) ---
        // I am including the Massive List logic here efficiently
        const dlChannelNames = [
            "ABC USA","A&E USA","AMC USA","Animal Planet","ACC Network USA","Astro SuperSport 1","Astro SuperSport 2","Astro SuperSport 3","Astro SuperSport 4",
            "Arena Sport 1 Premium","Arena Sport 2 Premium","Arena Sport 3 Premium","Arena Sport 1 Serbia","Arena Sport 2 Serbia","Arena Sport 3 Serbia","Arena Sport 4 Serbia",
            "Arena Sport 1 Croatia","Arena Sport 2 Croatia","Arena Sport 3 Croatia","Arena Sport 4 Croatia","Alkass One","Alkass Two","Alkass Three","Alkass Four",
            "ABS-CBN","Arena Sport 1 BiH","Abu Dhabi Sports 1 UAE","Abu Dhabi Sports 2 UAE","Abu Dhabi Sports 1 Premium","Abu Dhabi Sports 2 Premium","Astro Cricket",
            "Antena 3 Spain","Adult Swim","AXN Movies Portugal","Arte DE","AXS TV USA","ABCNY USA","beIN Sports MENA English 1","beIN Sports MENA English 2",
            "beIN Sports MENA English 3","beIN Sports MENA 1","beIN Sports MENA 2","beIN Sports MENA 3","beIN Sports MENA 4","beIN Sports MENA 5","beIN Sports MENA 6",
            "beIN Sports MENA 7","beIN Sports MENA Premium 1","beIN Sports MENA Premium 2","beIN Sports MENA Premium 3","beIN Sports MAX 4 France","beIN Sports MAX 5 France",
            "beIN Sports MAX 6 France","beIN Sports MAX 7 France","beIN Sports MAX 8 France","beIN Sports MAX 9 France","beIN Sports MAX 10 France","beIN SPORTS 1 France",
            "beIN SPORTS 2 France","beIN SPORTS 3 France","beIN SPORTS 1 Turkey","beIN SPORTS 2 Turkey","beIN SPORTS 3 Turkey","beIN SPORTS 4 Turkey","BeIN Sports HD Qatar",
            "BeIN SPORTS USA","beIN SPORTS en Español","beIN SPORTS Australia 1","beIN SPORTS Australia 2","beIN SPORTS Australia 3","Barca TV Spain","Benfica TV PT",
            "Boomerang","BNT 1 Bulgaria","BNT 2 Bulgaria","BNT 3 Bulgaria","BR Fernsehen DE","bTV Bulgaria","bTV Action Bulgaria","bTV Lady Bulgaria","BBC America (BBCA)",
            "BET USA","Bravo USA","BBC News Channel HD","BBC One UK","BBC Two UK","BBC Three UK","BBC Four UK","BIG TEN Network (BTN USA)","Cuatro Spain","Channel 4 UK",
            "Channel 5 UK","CBS Sports Network (CBSSN)","Canal+ France","Canal+ Sport France","Canal+ Foot France","Canal+ Sport360","Canal 11 Portugal","Canal+ Sport Poland",
            "Canal+ Sport 2 Poland","CANAL+ SPORT 5 Poland","Canal+ Premium Poland","Canal+ Family Poland","Canal+ Seriale Poland","Canal+ Sport 1 Afrique","Canal+ Sport 2 Afrique",
            "Canal+ Sport 3 Afrique","Canal+ Sport 4 Afrique","Canal+ Sport 5 Afrique","CANAL9 Denmark","Combate Brasil","C More Football Sweden","Cosmote Sport 1 HD",
            "Cosmote Sport 2 HD","Cosmote Sport 3 HD","Cosmote Sport 4 HD","Cosmote Sport 5 HD","Cosmote Sport 6 HD","Cosmote Sport 7 HD","Cosmote Sport 8 HD","Cosmote Sport 9 HD",
            "Channel 9 Israel","Channel 10 Israel","Channel 11 Israel","Channel 12 Israel","Channel 13 Israel","Channel 14 Israel","C More Stars Sweden","C More First Sweden",
            "C More Hits Sweden","C More Series Sweden","COZI TV USA","CMT USA","CBS USA","CW USA","CNBC USA","Comedy Central","Cartoon Network","CNN USA","Cinemax USA",
            "CTV Canada","CTV 2 Canada","Crime+ Investigation USA","Comet USA","Cooking Channel USA","Cleo TV","C SPAN 1","CBSNY USA","Citytv","CBC CA","DAZN 1 Bar DE",
            "DAZN 2 Bar DE","DAZN 1 Spain","DAZN 2 Spain","DAZN 3 Spain","DAZN 4 Spain","DAZN F1 ES","DAZN LaLiga","DAZN LaLiga 2","DR1 Denmark","DR2 Denmark",
            "Digi Sport 1 Romania","Digi Sport 2 Romania","Digi Sport 3 Romania","Digi Sport 4 Romania","Diema Sport Bulgaria","Diema Sport 2 Bulgaria","Diema Sport 3 Bulgaria",
            "Diema Bulgaria","Diema Family Bulgaria","Dubai Sports 1 UAE","Dubai Sports 2 UAE","Dubai Sports 3 UAE","Dubai Racing 1 UAE","Dubai Racing 2 UAE","DSTV Mzansi Magic",
            "DSTV M-Net","DSTV kykNET & kie","Discovery Life Channel","Disney Channel","Discovery Channel","Discovery Family","Disney XD","Destination America","Disney JR",
            "Dave","ESPN USA","ESPN2 USA","ESPNU USA","ESPN 1 NL","ESPN 2 NL","Eleven Sports 1 Poland","Eleven Sports 2 Poland","Eleven Sports 3 Poland","Eleven Sports 1 Portugal",
            "Eleven Sports 2 Portugal","Eleven Sports 3 Portugal","Eleven Sports 4 Portugal","Eleven Sports 5 Portugal","EuroSport 1 UK","EuroSport 2 UK","EuroSport 1 Poland",
            "EuroSport 2 Poland","EuroSport 1 Spain","EuroSport 2 Spain","EuroSport 1 Italy","EuroSport 2 Italy","Eurosport 1 Bulgaria","Eurosport 2 Bulgaria",
            "ESPN Premium Argentina","ESPN Brasil","ESPN2 Brasil","ESPN3 Brasil","ESPN4 Brasil","ESPN SUR","ESPN2 SUR","ESPN Deportes","ESPNews","E! Entertainment Television",
            "E4 Channel","Fox Sports 1 USA","Fox Sports 2 USA","FOX Soccer Plus","Fox Cricket","FOX Deportes USA","FOX Sports 502 AU","FOX Sports 503 AU","FOX Sports 504 AU",
            "FOX Sports 505 AU","FOX Sports 506 AU","FOX Sports 507 AU","Fox Sports Argentina","Fox Sports 2 Argentina","Fox Sports 3 Argentina","Fox Sports Premium MX",
            "FilmBox Premium Poland","Fight Network","Fox Business","FOX HD Bulgaria","FOX USA","FX USA","FXX USA","Freeform","Fox News","FX Movie Channel","FYI","Film4 UK",
            "Fashion TV","FETV - Family Entertainment Television","FOXNY USA","Fox Weather Channel","GOL PLAY Spain","GOLF Channel USA","Game Show Network","Gol Mundial 1",
            "Gold UK","Galavisión USA","Grit Channel","Globo SP","Globo RIO","Global CA","The Hallmark Channel","Hallmark Movies & Mysterie","HBO USA","HBO2 USA",
            "HBO Comedy USA","HBO Family USA","HBO Latino USA","HBO Signature USA","HBO Zone USA","HBO Poland","History USA","Headline News","HGTV","HOT3 Israel",
            "HR Fernsehen DE","ITV 1 UK","ITV 2 UK","ITV 3 UK","ITV 4 UK","Italia 1 Italy","Investigation Discovery (ID USA)","ION USA","IFC TV USA","Kanal 4 Denmark",
            "Kanal 5 Denmark","Kabel Eins (Kabel 1) DE","LaLiga SmartBank TV","L'Equipe France","La Sexta Spain","Liverpool TV (LFC TV)","Lifetime Network","Lifetime Movies Network",
            "Longhorn Network USA","La7 Italy","LA7d HD+ Italy","Match Football 1 Russia","Match Football 2 Russia","Match Football 3 Russia","Match Premier Russia",
            "Match TV Russia","МАТЧ! БОЕЦ Russia","Movistar Laliga","Movistar Liga de Campeones","Movistar Deportes Spain","Movistar Deportes 2 Spain","Movistar Deportes 3 Spain",
            "Movistar Deportes 4 Spain","Movistar Golf Spain","Motowizja Poland","MSG USA","MSNBC","Magnolia Network","MTV UK","MTV USA","MUTV UK","MAVTV USA",
            "Max Sport 1 Croatia","Max Sport 2 Croatia","Marquee Sports Network","Max Sport 1 Bulgaria","Max Sport 2 Bulgaria","Max Sport 3 Bulgaria","Max Sport 4 Bulgaria",
            "MLB Network USA","MASN USA","MY9TV USA","Motor Trend","METV USA","MDR DE","Mundotoro TV Spain","MTV Denmark","NHL Network USA","Nova Sport Bulgaria",
            "Nova Sport Serbia","Nova Sports 1 Greece","Nova Sports 2 Greece","Nova Sports 3 Greece","Nova Sports 4 Greece","Nova Sports 5 Greece","Nova Sports 6 Greece",
            "Nova Sports Premier League Greece","Nova Sports Start Greece","Nova Sports Prime Greece","Nova Sports News Greece","NESN USA","NBC USA","NBA TV USA",
            "NBC Sports Chicago","NBC Sports Philadelphia","NBC Sports Washington","NFL Network","NBC Sports Bay Area","NBC Sports Boston","NBC Sports California","NBCNY USA",
            "Nova TV Bulgaria","National Geographic (NGC)","NICK JR","NICK","Nick Music","Nicktoons","NDR DE","NewsNation USA","Newsmax USA","Nat Geo Wild USA","Noovo CA",
            "New! CWPIX 11","OnTime Sports","OnTime Sports 2","ONE 1 HD Israel","ONE 2 HD Israel","Orange Sport 1 Romania","Orange Sport 2 Romania","Orange Sport 3 Romania",
            "Orange Sport 4 Romania","Oprah Winfrey Network (OWN)","Oxygen True Crime","Polsat Poland","Polsat Sport Poland","Polsat Sport Extra Poland",
            "Polsat Sport News Poland","Polsat News Poland","Polsat Film Poland","Porto Canal Portugal","ProSieben (PRO7) DE","PTV Sports","Premier Brasil","Prima Sport 1",
            "Prima Sport 2","Prima Sport 3","Prima Sport 4","Paramount Network","POP TV USA","RTE 1","RTE 2","RMC Sport 1 France","RMC Sport 2 France","RTP 1 Portugal",
            "RTP 2 Portugal","RTP 3 Portugal","Rai 1 Italy","Rai 2 Italy","Rai 3 Italy","Rai Sport Italy","Rai Premium Italy","Real Madrid TV Spain","RDS CA","RDS 2 CA",
            "RDS Info CA","Ring Bulgaria","RTL7 Netherland","Racing Tv UK","Reelz Channel","Sky Sports Football UK","Sky Sports Arena UK","Sky Sports Action UK",
            "Sky Sports Main Event","Sky sports Premier League","Sky Sports F1 UK","Sky Sports Cricket","Sky Sports Golf UK","Sky Sports Golf Italy","Sky Sport MotoGP Italy",
            "Sky Sport Tennis Italy","Sky Sport F1 Italy","Sky Sports News UK","Sky Sports MIX UK","Sky Sport Top Event DE","Sky Sport Mix DE","Sky Sport Bundesliga 1 HD",
            "Sky Sport Austria 1 HD","SportsNet New York (SNY)","Sky Sport Football Italy","Sky Sport UNO Italy","Sky Sport Arena Italy","Sky Sports Racing UK","Sky UNO Italy",
            "Sky Sport 1 NZ","Sky Sport 2 NZ","Sky Sport 3 NZ","Sky Sport 4 NZ","Sky Sport 5 NZ","Sky Sport 6 NZ","Sky Sport 7 NZ","Sky Sport 8 NZ","Sky Sport 9 NZ",
            "Sky Sport Select NZ","Sport TV1 Portugal","Sport TV2 Portugal","Sport TV4 Portugal","Sport TV3 Portugal","Sport TV5 Portugal","Sport TV6 Portugal","SIC Portugal",
            "SEC Network USA","SporTV Brasil","SporTV2 Brasil","SporTV3 Brasil","Sport Klub 1 Serbia","Sport Klub 2 Serbia","Sport Klub 3 Serbia","Sport Klub 4 Serbia",
            "Sport Klub HD Serbia","Sportsnet Ontario","Sportsnet One","Sportsnet West","Sportsnet East","Sportsnet 360","Sportsnet World","SuperSport Grandstand",
            "SuperSport PSL","SuperSport Premier league","SuperSport LaLiga","SuperSport Variety 1","SuperSport Variety 2","SuperSport Variety 3","SuperSport Variety 4",
            "SuperSport Action","SuperSport Rugby","SuperSport Golf","SuperSport Tennis","SuperSport Motorsport","Supersport Football","SuperSport Cricket",
            "SuperSport MaXimo 1","Sporting TV Portugal","SportDigital Fussball","Spectrum Sportsnet LA","Sport1+ Germany","Sport1 Germany","S4C UK","SAT.1 DE",
            "Sky Cinema Premiere UK","Sky Cinema Select UK","Sky Cinema Hits UK","Sky Cinema Greats UK","Sky Cinema Animation UK","Sky Cinema Family UK",
            "Sky Cinema Action UK","Sky Cinema Thriller UK","Sky Cinema Sci-Fi Horror UK","Sky Cinema Collection Italy","Sky Cinema Uno Italy","Sky Cinema Action Italy",
            "Sky Cinema Comedy Italy","Sky Cinema Uno +24 Italy","Sky Cinema Romance Italy","Sky Cinema Family Italy","Sky Cinema Due +24 Italy","Sky Cinema Drama Italy",
            "Sky Cinema Suspense Italy","Sky Sport 24 Italy","Sky Sport Calcio Italy","Sky Calcio 1 (251) Italy","Sky Calcio 2 (252) Italy","Sky Calcio 3 (253) Italy",
            "Sky Calcio 4 (254) Italy","Sky Calcio 5 (255) Italy","Sky Calcio 6 (256) Italy","Sky Calcio 7 (257) Italy","Sky Serie Italy","StarzPlay CricLife 1 HD",
            "StarzPlay CricLife 2 HD","StarzPlay CricLife 3 HD","Sky Showcase UK","Sky Arts UK","Sky Comedy UK","Sky Crime","Sky History","SSC Sport 1","SSC Sport 2",
            "SSC Sport 3","SSC Sport 4","SSC Sport 5","SSC Sport Extra 1","SSC Sport Extra 2","SSC Sport Extra 3","Sport 1 Israel","Sport 2 Israel","Sport 3 Israel",
            "Sport 4 Israel","Sport 5 Israel","Sport 5 PLUS Israel","Sport 5 Live Israel","Sport 5 Star Israel","Sport 5 Gold Israel","Science Channel","Showtime USA",
            "Showtime SHOxBET USA","Starz","Sky Witness HD","Sixx DE","Sky Atlantic","SYFY USA","Sundance TV","SWR DE","SUPER RTL DE","SR Fernsehen DE",
            "Smithsonian Channel","TNT Sports 1 UK","TNT Sports 2 UK","TNT Sports 3 UK","TNT Sports 4 UK","TSN1","TSN2","TSN3","TSN4","TSN5","TVN HD Poland",
            "TVN24 Poland","TVP1 Poland","TVP2 Poland","Telecinco Spain","TVE La 1 Spain","TVE La 2 Spain","TVI Portugal","TVI Reality Portugal","Teledeporte Spain (TDP)",
            "TYC Sports Argentina","TVP Sport Poland","TNT Brasil","TNT Sports Argentina","TNT Sports HD Chile","Tennis Channel","Ten Sports PK","TUDN USA","Telemundo",
            "TBS USA","TLC","TNT USA","TVA Sports","TVA Sports 2","Travel Channel","TruTV USA","TVLAND","TCM USA","TMC Channel USA","The Food Network","The Weather Channel",
            "TVP INFO","TeenNick","TV ONE USA","TV2 Bornholm Denmark","TV2 Sport X Denmark","TV3 Sport Denmark","TV2 Sport Denmark","TV2 Denmark","TV2 Zulu","TV3+ Denmark",
            "TVO CA","Tennis+ 1","Tennis+ 2","Tennis+ 3","Tennis+ 4","Tennis+ 5","Tennis+ 6","Tennis+ 7","Tennis+ 8","Tennis+ 9","Tennis+ 10","Tennis+ 11","Tennis+ 12",
            "Tennis+ 13","Tennis+ 14","Tennis+ 15","USA Network","Universal Kids USA","Univision","Unimas","Viaplay Sports 1 UK","Viaplay Sports 2 UK","Viaplay Xtra UK",
            "#Vamos Spain","V Film Premiere","V Film Family","VH1 USA","Veronica NL Netherland","VTV+ Uruguay","VICE TV","Willow Cricket","Willow XTRA","WWE Network",
            "Win Sports+ Columbia","WETV USA","WDR DE","YES Network USA","Yes Movies Action Israel","Yes Movies Kids Israel","Yes Movies Comedy Israel","Yas TV UAE",
            "Yes TV CA","Ziggo Sport Docu NL","Ziggo Sport Select NL","Ziggo Sport Racing NL","Ziggo Sport Voetbal NL","BBC 1 DE","ZDF Info DE","20 Mediaset Italy",
            "6'eren Denmark","#0 Spain","5 USA","3sat DE"
        ];

        // --- DADDYLIVE LOGIC ---
        function loadDaddyLive() {
            allChannels = dlChannelNames.map((name, index) => {
                return {
                    name: name,
                    group: "DADDYLIVE",
                    source: "DLHD",
                    url: `https://dlhd.link/stream/stream-${index + 1}.php`,
                    isIframe: true,
                    isDaddy: true
                };
            });
            renderList(allChannels);
            document.getElementById('loadScreen').style.display = 'none';
            document.getElementById('listView').style.display = 'flex';
        }

        // --- FOX TV LOGIC ---
        function loadFoxTV() {
            document.getElementById('loadScreen').style.display = 'none';
            document.getElementById('listView').style.display = 'none';
            document.getElementById('playerView').style.display = 'flex';
            playIframe("https://dlhd.link/stream/stream-54.php", "FOX LIVE", "fox");
        }

        // --- UI UTILS ---
        function addInputRow() {
            const container = document.getElementById('inputContainer');
            const div = document.createElement('div');
            div.className = 'input-row';
            div.innerHTML = `
                <input type="text" class="url-input" placeholder="Another Playlist URL...">
                <button class="btn-action btn-red" onclick="removeRow(this)" style="width:50px; margin:0;"><i class="fa-solid fa-times"></i></button>
            `;
            container.appendChild(div);
        }
        function removeRow(btn) { btn.parentElement.parentElement.remove(); }
        
        function logStatus(msg, type='info') {
            const log = document.getElementById('statusLog');
            const color = type === 'error' ? 'var(--accent-red)' : (type === 'success' ? 'var(--accent-cyan)' : 'var(--text-dim)');
            log.innerHTML += `<div style="color:${color}; margin-bottom:4px;">> ${msg}</div>`;
            log.scrollTop = log.scrollHeight;
        }

        // --- PLAYLIST FETCH LOGIC ---
        async function fetchSmart(url) {
            try {
                const response = await fetch(url);
                if (response.ok) return await response.text();
                throw new Error("Direct failed");
            } catch (e) {
                try {
                    const proxyUrl = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(url);
                    const response = await fetch(proxyUrl);
                    if (response.ok) return await response.text();
                    throw new Error("Proxy failed");
                } catch (e2) {
                    const proxyUrl2 = 'https://corsproxy.io/?' + encodeURIComponent(url);
                    const response = await fetch(proxyUrl2);
                    if (response.ok) return await response.text();
                    throw new Error("All proxies failed");
                }
            }
        }

        async function loadAllPlaylists() {
            const inputs = document.querySelectorAll('.url-input');
            document.getElementById('statusLog').innerHTML = '';
            
            let urls = [];
            inputs.forEach(input => { if(input.value.trim()) urls.push(input.value.trim()); });
            
            if(urls.length === 0) return alert("Please enter a URL.");

            allChannels = []; 
            logStatus("Connecting to satellites...", 'info');

            for (let i = 0; i < urls.length; i++) {
                let url = urls[i];
                let sourceLabel = 'Source ' + (i+1);
                
                try {
                    const content = await fetchSmart(url);
                    const newChannels = parseM3U(content, sourceLabel);
                    if(newChannels.length > 0) {
                        logStatus(`Loaded ${newChannels.length} channels`, 'success');
                        allChannels = allChannels.concat(newChannels);
                    } else {
                        logStatus(`Empty playlist: ${sourceLabel}`, 'error');
                    }
                } catch (e) {
                    logStatus(`Failed to load: ${sourceLabel}`, 'error');
                }
            }

            if(allChannels.length > 0) {
                renderList(allChannels); 
                document.getElementById('loadScreen').style.display = 'none';
                document.getElementById('listView').style.display = 'flex';
            } else {
                alert("No channels found. Check logs.");
            }
        }

        function parseM3U(content, sourceLabel) {
            const lines = content.split('\n');
            const channels = [];
            let current = {};
            lines.forEach(line => {
                line = line.trim();
                if(line.startsWith('#EXTINF:')) {
                    const logo = line.match(/tvg-logo="([^"]*)"/);
                    const group = line.match(/group-title="([^"]*)"/);
                    const name = line.substring(line.lastIndexOf(',') + 1).trim();
                    current.logo = logo ? logo[1] : null;
                    current.group = group ? group[1] : 'General';
                    current.name = name || 'Unknown Channel';
                } else if(line.startsWith('http') || line.endsWith('.m3u8') || line.endsWith('.ts')) {
                    current.url = line;
                    current.source = sourceLabel;
                    current.isIframe = false;
                    if(current.name) channels.push(current);
                    current = {};
                }
            });
            return channels;
        }

        // --- RENDER LOGIC (GRID) ---
        function renderList(channels) {
            const container = document.getElementById('listContent');
            container.innerHTML = ''; 
            
            // Limit initial render for speed
            const subset = channels.slice(0, RENDER_LIMIT);
            const fragment = document.createDocumentFragment();

            subset.forEach(ch => {
                const card = document.createElement('div');
                card.className = 'channel-card';
                card.onclick = () => decidePlayer(ch.url, ch.isIframe, ch.isDaddy);
                
                // Determine Badges
                let badgeClass = 'bg-cyan';
                if(ch.group === 'DADDYLIVE') badgeClass = 'bg-purple';
                
                // Fallback Logo
                const logoHtml = ch.logo 
                    ? `<img src="${ch.logo}" onerror="this.style.display='none'">` 
                    : `${ch.name.substring(0,2)}`;

                card.innerHTML = `
                    <div class="card-logo">${logoHtml}</div>
                    <div class="card-info">
                        <div class="card-title">${ch.name}</div>
                        <div class="card-meta">
                            <span class="badge ${badgeClass}">${ch.source}</span>
                            <span class="badge bg-gray">${ch.group}</span>
                        </div>
                    </div>
                    <i class="fa-solid fa-play play-icon"></i>
                `;
                fragment.appendChild(card);
            });
            
            container.appendChild(fragment);

            // Infinite Scroll / Load More Placeholder
            if(channels.length > RENDER_LIMIT) {
                const info = document.createElement('div');
                info.style.textAlign = 'center';
                info.style.color = 'var(--text-dim)';
                info.style.padding = '20px';
                info.style.gridColumn = '1 / -1';
                info.innerText = `Showing top ${RENDER_LIMIT} of ${channels.length} channels...`;
                container.appendChild(info);
            }
        }

        function handleSearch() {
            clearTimeout(searchTimer);
            searchTimer = setTimeout(() => {
                const term = document.getElementById('channelSearch').value.toLowerCase();
                const filtered = allChannels.filter(ch => 
                    ch.name.toLowerCase().includes(term) || 
                    ch.group.toLowerCase().includes(term)
                );
                renderList(filtered);
            }, 300);
        }

        // --- PLAYER LOGIC ---
        function decidePlayer(url, isIframe, isDaddy) {
            document.getElementById('listView').style.display = 'none';
            document.getElementById('playerView').style.display = 'flex';

            if(isIframe) {
                playIframe(url, isDaddy ? "DADDY LIVE" : "LIVE STREAM", isDaddy ? "daddy" : "iframe");
            } else {
                playHLS(url);
            }
        }

        function playIframe(url, label, type) {
            // Reset state
            video.style.display = 'none';
            video.pause();
            foxContainer.style.display = 'none';
            daddyContainer.style.display = 'none';
            
            // Activate specific container
            let target;
            if (type === 'fox') target = foxContainer;
            else target = daddyContainer;
            
            target.style.display = 'block';
            target.innerHTML = `<iframe src="${url}" allowfullscreen allow="encrypted-media"></iframe>`;
            
            resBadge.innerText = label;
            resBadge.style.color = "var(--accent-red)";
            resBadge.style.borderColor = "var(--accent-red)";
        }

        function playHLS(url) {
            // Reset state
            foxContainer.innerHTML = '';
            daddyContainer.innerHTML = '';
            foxContainer.style.display = 'none';
            daddyContainer.style.display = 'none';
            
            video.style.display = 'block';
            resBadge.innerText = "HLS STREAM";
            resBadge.style.color = "var(--accent-yellow)";
            resBadge.style.borderColor = "var(--accent-yellow)";

            if(Hls.isSupported()) {
                if(hls) hls.destroy();
                hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(video);
                hls.on(Hls.Events.MANIFEST_PARSED, () => video.play());
            } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                video.src = url;
                video.play();
            }
        }

        function toggleCustomFullscreen() {
            if (!document.fullscreenElement) {
                playerBody.requestFullscreen();
                playerBody.classList.add('is-fullscreen');
            } else {
                document.exitFullscreen();
                playerBody.classList.remove('is-fullscreen');
            }
        }

        function goBack() {
            video.pause();
            foxContainer.innerHTML = '';
            daddyContainer.innerHTML = '';
            if(hls) hls.destroy();
            
            document.getElementById('playerView').style.display = 'none';
            
            // Check where to return
            if (foxContainer.style.display === 'block') {
                 // From Fox TV -> Home
                 document.getElementById('loadScreen').style.display = 'flex';
            } else {
                // From Grid -> Grid
                document.getElementById('listView').style.display = 'flex';
            }
        }
    </script>
</body>
</html>
